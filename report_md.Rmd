---
title: "Infant Touchscreen Use and Sleep Problems"
author: "Jessica Scarborough"
date: "5/7/2017"
output:
  html_document:
    theme: journal
    toc: true
    toc_depth: 4
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
require(truncnorm)
```

# Report Description

This report examines data simulation, exporation, and modeling analysis. The exploration portion of the project utilizes data visualization and MANOVA analysis. Modeling will begin with simple regression, and then move to multivariate multiple regression, ending with path analysis. 

**Predictor variables:**

* Age
* Gender
* Background TV
* Touchscreen use
* Night-time sleep duration
* Daytime sleep duration
* Average number of night awakenings
* Sleep onset

**Outcome variables:**

* Night-time sleep duration
* Daytime sleep duration
* Sleep onset
* Average number of night awakenings

# Data Simulation

**Count variables:**
```{r}
total.n <- 715

total.n.6_11 <- 134
total.n.12_18 <- 215
total.n.19_25 <- 179
total.n.26_36 <- 187

# N values for each age group in touchscreen use feature
screen.n.6_11 <- 123
screen.n.12_18 <- 194
screen.n.19_25 <- 145
screen.n.26_36 <- 151

# N values for each age group in background tv feature
tv.n.6_11 <- 123
tv.n.12_18 <- 194
tv.n.19_25 <- 145
tv.n.26_36 <- 151

```

**Touchscreen Variables:**
```{r}
screen.mean.6_11 <- 8.53
screen.mean.12_18 <- 18.80
screen.mean.19_25 <- 25.18
screen.mean.26_36 <- 44.11

screen.sd.6_11 <- 15.54
screen.sd.12_18 <- 36.83
screen.sd.19_25 <- 37.46
screen.sd.26_36 <- 47.75
```




**Onset Variables**:
```{r}
onset.n.6_11 <- 116
onset.n.12_18 <- 177
onset.n.19_25 <- 131
onset.n.26_36 <- 130

onset.sd.6_11 <- 23.69
onset.sd.12_18 <- 16.53
onset.sd.19_25 <- 16.97
onset.sd.26_36 <- 27.86

onset.mean.6_11 <- 22.80
onset.mean.12_18 <- 21.54
onset.mean.19_25 <- 22.22
onset.mean.26_36 <- 29.34


```

##Age

I chose to simulate the age data with uniform distribution instead of rnorm, because there's no mention of normal distribution of age in the article. Additionally, normal distribution insinuates that there are very few samples on the lower and upper limits of each age group. This is not indicated in the paper. This makes uniform distribution a better option. 

```{r}
age.6_11 <- runif(n=total.n.6_11, min = 6, max = 11.9)
sd(age.6_11)
# sim sd: ~ 1.7
# original sd: 1.82
age.12_18 <- runif(n=total.n.12_18, min = 12, max = 18.9)
sd(age.12_18)
# sim sd: ~ 2.0
# original sd: 2.19

age.19_25 <- runif(n=total.n.19_25, min = 18, max = 25.9)
sd(age.19_25)
# sim sd: ~ 2.4
# original sd: 2.07

age.26_36 <- rnorm(n=total.n.26_36, mean=30.64, sd=3.07)
age.26_36 <- runif(n=total.n.26_36, min = 26, max = 36.9)
sd(age.26_36)
# sim sd: ~ 3.1
# original sd: 3.07


age <- c(age.6_11, age.12_18, age.19_25, age.26_36)
sd(age)
# sim sd: ~ 8.6
# original sd: 8.26

hist(age)
hist(age.6_11)
hist(age.12_18)
hist(age.19_25)
hist(age.26_36)


# vectors with imputed data for future simulation needs

impute.age.6_11 <- replace(age.6_11, is.na(age.6_11), 
                              mean(age.6_11, na.rm=TRUE))
impute.age.12_18 <- replace(age.12_18, is.na(age.12_18), 
                               mean(age.12_18, na.rm=TRUE))
impute.age.19_25 <- replace(age.19_25, is.na(age.19_25), 
                               mean(age.19_25, na.rm=TRUE))
impute.age.26_36 <- replace(age.26_36, is.na(age.26_36), 
                               mean(age.26_36, na.rm=TRUE))



```

##Touchscreen Use
```{r}
# set.seed(0)

screen.6_11 <- (0.7)* rnorm(n=total.n.6_11, mean=(screen.mean.6_11-2.5), sd=screen.sd.6_11) + 
                (0.3)* rnorm(n=total.n.6_11, mean=3, sd=5)
screen.6_11 <- replace(screen.6_11, screen.6_11<0, 0)
screen.6_11[sample(1:length(screen.6_11), 
                   size = (total.n.6_11-screen.n.6_11), replace = FALSE)] <- NA
hist(screen.6_11)
sd(screen.6_11, na.rm = TRUE)
mean(screen.6_11, na.rm = TRUE)
# Sim mean typically hovers between 6.5-8.5
# Original mean: 7.53

# set.seed(0)
screen.12_18 <- (0.7)* rnorm(n=total.n.12_18, mean=(screen.mean.12_18-4), sd=screen.sd.12_18) + 
  (0.3)* rnorm(n=total.n.12_18, mean=10, sd=10)
screen.12_18 <- replace(screen.12_18, screen.12_18<0, 0)
screen.12_18[sample(1:length(screen.12_18), 
                    size = (total.n.12_18-screen.n.12_18), replace = FALSE)] <- NA
hist(screen.12_18)
sd(screen.12_18, na.rm = TRUE)
mean(screen.12_18, na.rm = TRUE)
# Sim mean typically hovers between 17-19.5
# Original mean: 18.8

# set.seed(0)
screen.19_25 <- (0.7)* rnorm(n=total.n.19_25, mean=(screen.mean.19_25-7), sd=screen.sd.19_25) + 
  (0.3)* rnorm(n=total.n.19_25, mean=15, sd=10)
screen.19_25 <- rnorm(n=total.n.19_25, mean=(25.18-7), sd=37.46)
screen.19_25 <- replace(screen.19_25, screen.19_25<0, 0)
screen.19_25[sample(1:length(screen.19_25), 
                    size = (total.n.19_25-screen.n.19_25), replace = FALSE)] <- NA
hist(screen.19_25)
sd(screen.19_25, na.rm = TRUE)
mean(screen.19_25, na.rm = TRUE)
# Final mean typically hovers between 24-28
# Original mean: 25.18

# set.seed(0)
screen.26_36 <- (0.7)* rnorm(n=total.n.26_36, mean=(screen.mean.26_36), sd=screen.sd.26_36) + 
  (0.3)* rnorm(n=total.n.26_36, mean=40, sd=10)
screen.26_36 <- replace(screen.26_36, screen.26_36<0, 0)
screen.26_36[sample(1:length(screen.26_36), 
                    size = (total.n.26_36-screen.n.26_36), replace = FALSE)] <- NA
hist(screen.26_36)
sd(screen.26_36, na.rm = TRUE)
mean(screen.26_36, na.rm = TRUE)
# Final mean typically hovers between 41-48
# Original mean: 44.11

hist(screen.6_11)
hist(screen.12_18)
hist(screen.19_25)
hist(screen.26_36)

screentime <- c(screen.6_11, screen.12_18, screen.19_25, screen.26_36)
hist(screentime)

# vectors with imputed data for future simulation needs
impute_screen.6_11 <- replace(screen.6_11, is.na(screen.6_11), 
                              mean(screen.6_11, na.rm=TRUE))
impute_screen.12_18 <- replace(screen.12_18, is.na(screen.12_18), 
                               mean(screen.12_18, na.rm=TRUE))
impute_screen.19_25 <- replace(screen.19_25, is.na(screen.19_25), 
                               mean(screen.19_25, na.rm=TRUE))
impute_screen.26_36 <- replace(screen.26_36, is.na(screen.26_36), 
                               mean(screen.26_36, na.rm=TRUE))

```
*For each age group*, the following steps were taken: 

1. Use rnorm to simulate data with the total n for the age group, discounting NA's for the time being, because we need the full indices in order to combine into a later df with age. 
2. Replace negative values with 0. Because this will raise the mean, I lowered the initial mean chosen with rnorm. 
3. Add in NA values based on the difference in the total n and the n for touchscreen use. 

**Note:** The final standard deviation values are not ideal using this procedure, but I decided that staying closer to the true mean (found in the original data set) was more important.


## Sex
```{r}
sex.6_11 <- rep(x = "Female", times = total.n.6_11)
sex.6_11[sample(1:length(sex.6_11), size=ceiling(total.n.6_11*0.5149), 
                replace = FALSE)] <- "Male"

sex.12_18 <- rep(x = "Female", times = total.n.12_18)
sex.12_18[sample(1:length(sex.12_18), size=ceiling(total.n.12_18*0.5302), 
                 replace = FALSE)] <- "Male"


sex.19_25 <- rep(x = "Female", times = total.n.19_25)
sex.19_25[sample(1:length(sex.19_25), size=ceiling(total.n.19_25*0.5587), 
                 replace = FALSE)] <- "Male"


sex.26_36 <- rep(x = "Female", times = total.n.26_36)
sex.26_36[sample(1:length(sex.26_36), size=ceiling(total.n.26_36*0.5134), 
               replace = FALSE)] <- "Male"

sex <- c(sex.6_11, sex.12_18, sex.19_25, sex.26_36)

```

*For each age group*, the following steps were taken: 

1. Use rep to create a vector with the total length N with "Female" as each value
2. Replace "Female" with "Male" based on the percetage of the age group that is male in the original data set


## Background TV

```{r}
# N values for each age group
tv.n.6_11 <- 123
tv.n.12_18 <- 194
tv.n.19_25 <- 145
tv.n.26_36 <- 151

# Screen values for each age group

tv_sd.6_11 <- 186.08
tv_sd.12_18 <- 172.70
tv_sd.19_25 <- 162.99
tv_sd.26_36 <-183.24

tv_mean.6_11 <- 209.72
tv_mean.12_18 <- 189.62
tv_mean.19_25 <- 187.00
tv_mean.26_36 <- 219.01

# Ratio balues for each age group
tv_screen.ratio.all <- 200.27/24.45
tv_screen.ratio.6_11 <- 209.72/8.53
tv_screen.ratio.12_18 <- 189.62/18.80
tv_screen.ratio.19_25 <- 187.00/25.18
tv_screen.ratio.26_36 <- 219.01/44.11



tv.6_11 <- (0.6)*(impute_screen.6_11 * tv_screen.ratio.6_11) + 
  (0.4)*(tv_mean.6_11 + rnorm(tv.n.6_11, sd=tv_sd.6_11))
tv.6_11[sample(1:length(tv.6_11), size=(total.n.6_11-tv.n.6_11), 
               replace = FALSE)] <- NA
tv.6_11 <- replace(tv.6_11, tv.6_11<0, 0)
hist(tv.6_11)
mean(tv.6_11, na.rm=TRUE)
# Sim mean hovers between: 199-211
# Original mean: 209.72


tv.12_18 <- (0.6)*(impute_screen.12_18 * tv_screen.ratio.12_18) + 
  (0.4)*(tv_mean.12_18 + rnorm(tv.n.12_18, sd=tv_sd.12_18))
tv.12_18[sample(1:length(tv.12_18), size=(total.n.12_18-tv.n.12_18), 
                replace = FALSE)] <- NA
tv.12_18 <- replace(tv.12_18, tv.12_18<0, 0)
hist(tv.12_18)
mean(tv.12_18, na.rm=TRUE)
# Sim mean hovers between: 185-196
# Original mean: 189.62


tv.19_25 <- (0.6)*(impute_screen.19_25 * tv_screen.ratio.19_25) + 
  (0.4)*(tv_mean.19_25 + rnorm(tv.n.19_25, sd=tv_sd.19_25))
tv.19_25[sample(1:length(tv.19_25), size=(total.n.19_25-tv.n.19_25), 
                replace = FALSE)] <- NA
tv.19_25 <- replace(tv.19_25, tv.19_25<0, 0)
hist(tv.19_25)
mean(tv.19_25, na.rm=TRUE)
# Sim mean hovers between: 175-195
# Original mean: 187.00

tv.26_36 <- (0.6)*(impute_screen.26_36 * tv_screen.ratio.26_36) + 
  (0.4)*(tv_mean.26_36 + rnorm(tv.n.26_36, mean=-10, sd=tv_sd.26_36))
tv.26_36[sample(1:length(tv.26_36), size=(total.n.26_36-tv.n.26_36), 
                replace = FALSE)] <- NA
tv.26_36 <- replace(tv.26_36, tv.26_36<0, 0)
mean(tv.26_36, na.rm=TRUE)
# Sim mean hovers between: 215-225
# Original mean: 219.01


tv <- c(tv.6_11, tv.12_18, tv.19_25, tv.26_36)
hist(tv)

```

*For each age group*, the following steps were taken: 

1. Weighted values for each TV sample were created using:
- (0.6 weight) Ratio of mean background TV and mean touchscreen use * the touchscreen use vector (with imputed mean data where there were previously NAs)
- (0.4 weight) Mean TV + random noise
- For age group 26-36 months: the final simulated mean was too high, so I made the noise more likely to decrease the samples
2. Negative values were set to 0
- This adds many 0s, but I think this is reasonable, because there are plenty of parents that do not allow TV at all.
3. NAs were added based on difference in n for this feature and overall

**Note:** It would be possible to simulate this data in the manner used to simulate the screen time data, but I hypothesize that children that are more likely to use touchscreens are also more likely to be exposed to background TV. This is not stated in the article, but is an assumption I am making. If this was not my assumption, then I could simulate this data independent of the touchscreen values, just replicating the mean and SD for each age group



## Night-time sleep duration
```{r}


# Overall values for each age group
ntsleep.n.6_11 <- 116
ntsleep.n.12_18 <- 176
ntsleep.n.19_25 <- 132
ntsleep.n.26_36 <- 130

ntsleep.sd.6_11 <- 64.81
ntsleep.sd.12_18 <- 50.13
ntsleep.sd.19_25 <- 60.12
ntsleep.sd.26_36 <-61.81

ntsleep.mean.6_11 <- 637.24
ntsleep.mean.12_18 <- 647.24
ntsleep.mean.19_25 <- 651.25
ntsleep.mean.26_36 <- 643.21


# Ratio values for each age group
ntsleep_screen_ratio.6_11 <- ntsleep.mean.6_11/screen.mean.6_11
ntsleep_screen_ratio.12_18 <- ntsleep.mean.12_18/screen.mean.12_18
ntsleep_screen_ratio.19_25 <- ntsleep.mean.19_25/screen.mean.19_25
ntsleep_screen_ratio.26_36 <- ntsleep.mean.26_36/screen.mean.26_36

ntsleep.6_11 <- rtruncnorm(n=total.n.6_11, a=(ntsleep.mean.6_11-ntsleep.sd.6_11*2), 
                            b=(ntsleep.mean.6_11+ntsleep.sd.6_11*3),
                            mean=ntsleep.mean.6_11+50,
                            sd=ntsleep.sd.6_11) - 
                0.08*(impute_screen.6_11 * ntsleep_screen_ratio.6_11)
ntsleep.6_11[sample(1:length(ntsleep.6_11), size=(total.n.6_11-ntsleep.n.6_11), 
               replace = FALSE)] <- NA
hist(ntsleep.6_11)
mean(ntsleep.6_11, na.rm=TRUE)
# Sim mean hovers around: 632-643
# Original mean: 637.24

ntsleep.12_18 <- rtruncnorm(n=total.n.12_18, a=(ntsleep.mean.12_18-ntsleep.sd.12_18*2), 
                           b=(ntsleep.mean.12_18+ntsleep.sd.12_18*3),
                           mean=ntsleep.mean.12_18+60,
                           sd=ntsleep.sd.12_18) - 
                0.08*(impute_screen.12_18 * ntsleep_screen_ratio.12_18)
ntsleep.12_18[sample(1:length(ntsleep.12_18), size=(total.n.12_18-ntsleep.n.12_18), 
                    replace = FALSE)] <- NA
hist(ntsleep.12_18)
mean(ntsleep.12_18, na.rm=TRUE)
# Sim mean hovers around: 639-656
# Original mean: 647.24


ntsleep.19_25 <- rtruncnorm(n=total.n.19_25, a=(ntsleep.mean.19_25-ntsleep.sd.19_25*2), 
                            b=(ntsleep.mean.19_25+ntsleep.sd.19_25*3),
                            mean=ntsleep.mean.19_25+50,
                            sd=ntsleep.sd.19_25) - 
                0.08*(impute_screen.19_25 * ntsleep_screen_ratio.19_25)
ntsleep.19_25[sample(1:length(ntsleep.19_25), size=(total.n.19_25-ntsleep.n.19_25), 
                     replace = FALSE)] <- NA
hist(ntsleep.19_25)
mean(ntsleep.19_25, na.rm=TRUE)
# Sim mean hovers between: 641-658
# Original mean: 651.25

ntsleep.26_36 <- rtruncnorm(n=total.n.26_36, a=(ntsleep.mean.26_36-ntsleep.sd.26_36*2), 
                            b=(ntsleep.mean.26_36+ntsleep.sd.26_36*3),
                            mean=ntsleep.mean.26_36+56,
                            sd=ntsleep.sd.26_36) - 
  0.08*(impute_screen.26_36 * ntsleep_screen_ratio.26_36)
ntsleep.26_36[sample(1:length(ntsleep.26_36), size=(total.n.26_36-ntsleep.n.26_36), 
                     replace = FALSE)] <- NA
hist(ntsleep.26_36)
mean(ntsleep.26_36, na.rm=TRUE)
# Sim mean hovers around: 638-651
# Original mean: 643.21


ntsleep <- c(ntsleep.6_11, ntsleep.12_18, ntsleep.19_25, ntsleep.26_36)
hist(ntsleep)


```
*For each age group*, the following steps were taken: 

1. Weighted values for each night-time sleep duration sample were created by first creating a truncated normal distribution with a slightly higher mean than the original. 
2. A formula was used to create a value (in minutes) that was higher for samples with more touchscreen time. This value was multiplied by 0.08 and subtracted from the sample. It was only minimally influential, because the correlation between touchscreen and nighttime sleep was only -0.29. This shows that there is some correlation, but it is not particularly strong, so I didn't want to over do it. 
    - Formula: (Age Group Nighttime Sleep Mean)/(Age Group Screen Use Mean) * (Sample Screen Use)
3. NAs were added based on difference in n for this feature and overall



## Daytime sleep duration

```{r}

# Overall values for each age group
daysleep.n.6_11 <- 116
daysleep.n.12_18 <- 176
daysleep.n.19_25 <- 132
daysleep.n.26_36 <- 126

daysleep.sd.6_11 <- 47.27
daysleep.sd.12_18 <- 38.40
daysleep.sd.19_25 <- 40.28
daysleep.sd.26_36 <- 53.20

daysleep.mean.6_11 <- 139.05
daysleep.mean.12_18 <- 122.47
daysleep.mean.19_25 <- 100.57
daysleep.mean.26_36 <- 68.25


# Ratio values for each age group
daysleep.screen_ratio.6_11 <- daysleep.mean.6_11/screen.mean.6_11
daysleep.screen_ratio.12_18 <- daysleep.mean.12_18/screen.mean.12_18
daysleep.screen_ratio.19_25 <- daysleep.mean.19_25/screen.mean.19_25
daysleep.screen_ratio.26_36 <- daysleep.mean.26_36/screen.mean.26_36


daysleep.6_11 <- rtruncnorm(n=total.n.6_11, a=(daysleep.mean.6_11-daysleep.sd.6_11*3), 
                            b=(daysleep.mean.6_11+daysleep.sd.6_11*2),
                            mean=daysleep.mean.6_11-5,
                            sd=daysleep.sd.6_11) + 
            0.05*(impute_screen.6_11 * daysleep.screen_ratio.6_11)
daysleep.6_11[sample(1:length(daysleep.6_11), size=(total.n.6_11-daysleep.n.6_11),
                    replace = FALSE)] <- NA
daysleep.6_11 <- replace(daysleep.6_11, daysleep.6_11<0, 0)
mean(daysleep.6_11, na.rm = TRUE)
# Simulated mean hovers around: 128-144
# Original mean: 139.05


daysleep.12_18 <- rtruncnorm(n=total.n.12_18, a=(daysleep.mean.12_18-daysleep.sd.12_18*3), 
                            b=(daysleep.mean.12_18+daysleep.sd.12_18*2),
                            mean=daysleep.mean.12_18-5,
                            sd=daysleep.sd.12_18) + 
  0.05*(impute_screen.12_18 * daysleep.screen_ratio.12_18)
daysleep.12_18[sample(1:length(daysleep.12_18), size=(total.n.12_18-daysleep.n.12_18),
                     replace = FALSE)] <- NA
daysleep.12_18 <- replace(daysleep.12_18, daysleep.12_18<0, 0)
mean(daysleep.12_18, na.rm = TRUE)
# Simulated mean hovers around: 120-125
# Original mean: 122.47


daysleep.19_25 <- rtruncnorm(n=total.n.19_25, a=(daysleep.mean.19_25-daysleep.sd.19_25*3), 
                             b=(daysleep.mean.19_25+daysleep.sd.19_25*2),
                             mean=daysleep.mean.19_25-5,
                             sd=daysleep.sd.19_25) + 
  0.05*(impute_screen.19_25 * daysleep.screen_ratio.19_25)
daysleep.19_25[sample(1:length(daysleep.19_25), size=(total.n.19_25-daysleep.n.19_25),
                     replace = FALSE)] <- NA
daysleep.19_25 <- replace(daysleep.19_25, daysleep.19_25<0, 0)
mean(daysleep.19_25, na.rm = TRUE)
# Simulated mean hovers around: 97-102
# Original mean: 100.57


daysleep.26_36 <- rtruncnorm(n=total.n.26_36, a=(daysleep.mean.26_36-daysleep.sd.26_36*3), 
                             b=(daysleep.mean.26_36+daysleep.sd.26_36*2),
                             mean=daysleep.mean.26_36-4,
                             sd=daysleep.sd.26_36) + 
  0.05*(impute_screen.26_36 * daysleep.screen_ratio.26_36)
daysleep.26_36[sample(1:length(daysleep.26_36), size=(total.n.26_36-daysleep.n.26_36),
                     replace = FALSE)] <- NA
daysleep.26_36 <- replace(daysleep.26_36, daysleep.26_36<0, 0)
mean(daysleep.26_36, na.rm = TRUE)
# Simulated mean hovers around: 59-78
# Original mean: 68.25


daysleep <- c(daysleep.6_11, daysleep.12_18, daysleep.19_25, daysleep.26_36)
hist(daysleep)
mean(daysleep, na.rm=TRUE)
# Simulated mean: 106.32
# Original mean: 108.29


```
*For each age group*, the following steps were taken: 

1. Weighted values for each daytime sleep duration sample were created by first creating a truncated normal distribution with a slightly higher mean than the original. 
2. A formula was used to create a value (in minutes) that was higher for samples with more touchscreen time. This value was multiplied by 0.05 and subtracted from the sample. It was only minimally influential, because the correlation between touchscreen and nighttime sleep was only 0.14. This shows that there is some correlation, but it is not particularly strong, so I didn't want to over do it. 
    - Formula: (Age Group Daytime Sleep Mean)/(Age Group Screen Use Mean) * (Sample Screen Use)
3. NAs were added based on difference in n for this feature and overall

## Total Sleep
```{r}

totalsleep <- ntsleep+daysleep

```


## Average number of night awakenings
```{r}

# Age means 
age.mean.6_11 <- 8.99
age.mean.12_18 <- 14.40
age.mean.19_25 <- 21.94
age.mean.26_36 <- 30.64


# Overall values for each age group

wake.n.6_11 <- 116
wake.n.12_18 <- 177
wake.n.19_25 <- 133
wake.n.26_36 <- 130

wake.sd.6_11 <- 1.73
wake.sd.12_18 <- 1.33
wake.sd.19_25 <- 1.01
wake.sd.26_36 <- 0.81

wake.mean.6_11 <- 2
wake.mean.12_18 <- 1.29
wake.mean.19_25 <- 0.91
wake.mean.26_36 <- 0.58


# Ratio values for each age group
wake.age_ratio.6_11 <- wake.mean.6_11/age.mean.6_11
wake.age_ratio.12_18 <- wake.mean.12_18/age.mean.12_18
wake.age_ratio.19_25 <- wake.mean.19_25/age.mean.19_25
wake.age_ratio.26_36 <- wake.mean.26_36/age.mean.26_36


wake.6_11 <- floor(rtruncnorm(n=total.n.6_11, a=(wake.mean.6_11-wake.sd.6_11*2), 
                            b=(wake.mean.6_11+wake.sd.6_11*3),
                            mean=wake.mean.6_11+0.75,
                            sd=wake.sd.6_11) - 
                  0.15*(impute.age.6_11 * wake.age_ratio.6_11))
wake.6_11[sample(1:length(wake.6_11), size=(total.n.6_11-wake.n.6_11),
                     replace = FALSE)] <- NA
wake.6_11 <- replace(wake.6_11, wake.6_11<0, 0)
mean(wake.6_11, na.rm = TRUE)
# Simulated mean hovers around: 1.75-2.19
# Original mean: 2


wake.12_18 <- floor(rtruncnorm(n=total.n.12_18, a=(wake.mean.12_18-wake.sd.12_18*2), 
                              b=(wake.mean.12_18+wake.sd.12_18*3),
                              mean=wake.mean.12_18+0.6,
                              sd=wake.sd.12_18) - 
                     0.15*(impute.age.12_18 * wake.age_ratio.12_18))
wake.12_18[sample(1:length(wake.12_18), size=(total.n.12_18-wake.n.12_18),
                      replace = FALSE)] <- NA
wake.12_18 <- replace(wake.12_18, wake.12_18<0, 0)
mean(wake.12_18, na.rm = TRUE)
# Simulated mean hovers around: 1.23-1.37
# Original mean: 1.29


wake.19_25 <- floor(rtruncnorm(n=total.n.19_25, a=(wake.mean.19_25-wake.sd.19_25*2), 
                               b=(wake.mean.19_25+wake.sd.19_25*3),
                               mean=wake.mean.19_25+0.55,
                               sd=wake.sd.19_25) - 
                      0.15*(impute.age.19_25 * wake.age_ratio.19_25))
wake.19_25[sample(1:length(wake.19_25), size=(total.n.19_25-wake.n.19_25),
                      replace = FALSE)] <- NA
wake.19_25 <- replace(wake.19_25, wake.19_25<0, 0)
mean(wake.19_25, na.rm = TRUE)
# Simulated mean hovers around: 0.85-1.06
# Original mean: 0.91


wake.26_36 <- floor(rtruncnorm(n=total.n.26_36, a=(wake.mean.26_36-wake.sd.26_36*2), 
                               b=(wake.mean.26_36+wake.sd.26_36*3),
                               mean=wake.mean.26_36+0.55,
                               sd=wake.sd.26_36) - 
                      0.15*(impute.age.26_36 * wake.age_ratio.26_36))
wake.26_36[sample(1:length(wake.26_36), size=(total.n.26_36-wake.n.26_36),
                      replace = FALSE)] <- NA
wake.26_36 <- replace(wake.26_36, wake.26_36<0, 0)
mean(wake.26_36, na.rm = TRUE)
# Simulated mean hovers around: 0.53-0.67
# Original mean: 0.58


wake <- c(wake.6_11, wake.12_18, wake.19_25, wake.26_36)
mean(wake, na.rm=TRUE)
# Sim mean: 1.23
# Original mean: 1.17

```
*For each age group*, the following steps were taken: 

1. Weighted values for each daytime sleep duration sample were created by first creating a truncated normal distribution with a slightly higher mean than the original. 
2. A formula was used to create a value (in minutes) that was *higher for samples with higher age*. Age was chosen in this simulation, because the original study shows that there is no significant correlation between screentime and average number of awakenings.  This value was multiplied by 0.15 and subtracted from sample. It was only minimally influential (although more influential than most variables), because the correlation between age and awakenings was -0.35. This shows that there is some correlation, but it is not particularly strong, so I didn't want to over do it. 
    - Formula: (Age Group Awakenings Mean)/(Age Group Age Mean) * (Sample Age)
3. NAs were added based on difference in n for this feature and overall

## Sleep onset
```{r}


# Ratio values for each age group
onset.screen_ratio.6_11 <- onset.mean.6_11/screen.mean.6_11
onset.screen_ratio.12_18 <- onset.mean.12_18/screen.mean.12_18
onset.screen_ratio.19_25 <- onset.mean.19_25/screen.mean.19_25
onset.screen_ratio.26_36 <- onset.mean.26_36/screen.mean.26_36



onset.6_11 <- rtruncnorm(n=total.n.6_11, a=(onset.mean.6_11-onset.sd.6_11*3), 
                            b=(onset.mean.6_11+onset.sd.6_11*2),
                            mean=onset.mean.6_11-5,
                            sd=onset.sd.6_11) + 
  0.07*(impute_screen.6_11 * onset.screen_ratio.6_11)
onset.6_11[sample(1:length(onset.6_11), size=(total.n.6_11-onset.n.6_11),
                     replace = FALSE)] <- NA
onset.6_11 <- replace(onset.6_11, onset.6_11<0, 0)
mean(onset.6_11, na.rm = TRUE)
# Simulated mean hovers around: 19.5-23.5
# Original mean: 22.8


onset.12_18 <- rtruncnorm(n=total.n.12_18, a=(onset.mean.12_18-onset.sd.12_18*3), 
                         b=(onset.mean.12_18+onset.sd.12_18*2),
                         mean=onset.mean.12_18-3,
                         sd=onset.sd.12_18) + 
  0.07*(impute_screen.12_18 * onset.screen_ratio.12_18)
onset.12_18[sample(1:length(onset.12_18), size=(total.n.12_18-onset.n.12_18),
                      replace = FALSE)] <- NA
onset.12_18 <- replace(onset.12_18, onset.12_18<0, 0)
mean(onset.12_18, na.rm = TRUE)
# Simulated mean hovers around: 19.5-22.5
# Original mean: 21.54


onset.19_25 <- rtruncnorm(n=total.n.19_25, a=(onset.mean.19_25-onset.sd.19_25*3), 
                         b=(onset.mean.19_25+onset.sd.19_25*2),
                         mean=onset.mean.19_25-1.5,
                         sd=onset.sd.19_25) + 
  0.07*(impute_screen.19_25 * onset.screen_ratio.19_25)
onset.19_25[sample(1:length(onset.19_25), size=(total.n.19_25-onset.n.19_25),
                      replace = FALSE)] <- NA
onset.19_25 <- replace(onset.19_25, onset.19_25<0, 0)
mean(onset.19_25, na.rm = TRUE)
# Simulated mean hovers around: 20-24
# Original mean: 22.22


onset.26_36 <- rtruncnorm(n=total.n.26_36, a=(onset.mean.26_36-onset.sd.26_36*3), 
                         b=(onset.mean.26_36+onset.sd.26_36*2),
                         mean=onset.mean.26_36-3.5,
                         sd=onset.sd.26_36) + 
  0.07*(impute_screen.26_36 * onset.screen_ratio.26_36)
onset.26_36[sample(1:length(onset.26_36), size=(total.n.26_36-onset.n.26_36),
                      replace = FALSE)] <- NA
onset.26_36 <- replace(onset.26_36, onset.26_36<0, 0)
mean(onset.26_36, na.rm = TRUE)
# Simulated mean hovers around: 27-32
# Original mean: 29.34


onset <- c(onset.6_11, onset.12_18, onset.19_25, onset.26_36)
mean(onset, na.rm=TRUE)
# Simulated mean: 23.16
# Original mean: 23.79

```
*For each age group*, the following steps were taken: 

1. Weighted values for each daytime sleep duration sample were created by first creating a truncated normal distribution with a slightly higher mean than the original. 
2. A formula was used to create a value (in minutes) that was higher for samples with more touchscreen time. This value was multiplied by 0.07 and subtracted from the sample. It was only minimally influential, because the correlation between touchscreen and nighttime sleep was only 0.21. This shows that there is some correlation, but it is not particularly strong, so I didn't want to over do it. 
    - Formula: (Age Group Daytime Sleep Mean)/(Age Group Screen Use Mean) * (Sample Screen Use)
3. NAs were added based on difference in n for this feature and overall

# Data Exploration

```{r}
shapiro.test(age)
shapiro.test(tv)
shapiro.test(screentime)
shapiro.test(ntsleep)
shapiro.test(daysleep)
shapiro.test(wake)
shapiro.test(onset)
```
In the original data, only the nightsleep (ntsleep) and daytime sleep (daysleep) are normally distributed. According to this shapiro wilks test, however, all of my data is normal. Considering that the rest of the metrics are okay, I am okay with this fact. 


# Modeling

## Basic Regression

## Multivariate Multiple Regression

## Path Analysis


# Appendix

