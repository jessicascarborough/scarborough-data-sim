---
title: "Infant Touchscreen Use and Sleep Problems"
author: "Jessica Scarborough"
date: "5/7/2017"
output:
  html_document:
    theme: journal
    toc: true
    toc_depth: 4
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Report Description

This report examines data simulation, exporation, and modeling analysis. The exploration portion of the project utilizes data visualization and MANOVA analysis. Modeling will begin with simple regression, and then move to multivariate multiple regression, ending with path analysis. 

# Data Simulation

**Count variables:**
```{r}
total.n <- 715

total.n.6_11 <- 134
total.n.12_18 <- 215
total.n.19_25 <- 179
total.n.26_36 <- 187

# N values for each age group in touchscreen use feature
screen.n.6_11 <- 123
screen.n.12_18 <- 194
screen.n.19_25 <- 145
screen.n.26_36 <- 151

# N values for each age group in background tv feature
tv.n.6_11 <- 123
tv.n.12_18 <- 194
tv.n.19_25 <- 145
tv.n.26_36 <- 151


```

##Age
```{r}
age.6_11 <- rnorm(n=total.n.6_11, mean=8.99, sd=1.82)
age.12_18 <- rnorm(n=total.n.12_18, mean=14.40, sd=2.19)
age.19_25 <- rnorm(n=total.n.19_25, mean=21.94, sd=2.07)
age.26_36 <- rnorm(n=total.n.26_36, mean=30.64, sd=3.07)

age <- c(age.6_11, age.12_18, age.19_25, age.26_36)

```

##Touchscreen Use
```{r}
# set.seed(0)
screen.6_11 <- rnorm(n=total.n.6_11, mean=(8.53-4), sd=15.54)
screen.6_11 <- replace(screen.6_11, screen.6_11<0, 0)
na_sample.6_11 <- sample(x=screen.6_11, 
                         size=(total.n.6_11-screen.n.6_11), 
                         replace=FALSE)
screen.6_11 <- replace(screen.6_11, na_sample.6_11, NA)
sd(screen.6_11, na.rm = TRUE)
mean(screen.6_11, na.rm = TRUE)
# Final mean typically hovers between 8-9

# set.seed(0)
screen.12_18 <- rnorm(n=total.n.12_18, mean=(18.80-12), sd=36.83)
screen.12_18 <- replace(screen.12_18, screen.12_18<0, 0)
na_sample.12_18 <- sample(x=screen.12_18, 
                          size=(total.n.12_18-screen.n.12_18), 
                          replace=FALSE)
screen.12_18 <- replace(screen.12_18, na_sample.12_18, NA)
sd(screen.12_18, na.rm = TRUE)
mean(screen.12_18, na.rm = TRUE)
# Final mean typically hoers between 17-20

# set.seed(0)
screen.19_25 <- rnorm(n=total.n.19_25, mean=(25.18-7), sd=37.46)
screen.19_25 <- replace(screen.19_25, screen.19_25<0, 0)
na_sample.19_25 <- sample(x=screen.19_25, 
                          size=(total.n.19_25-screen.n.19_25), 
                          replace=FALSE)
screen.19_25 <- replace(screen.19_25, na_sample.19_25, NA)
sd(screen.19_25, na.rm = TRUE)
mean(screen.19_25, na.rm = TRUE)
# Final mean typically hovers between 22-27

# set.seed(0)
screen.26_36 <- rnorm(n=total.n.26_36, mean=(44.11-4), sd=47.75)
screen.26_36 <- replace(screen.26_36, screen.26_36<0, 0)
na_sample.26_36 <- sample(x=screen.26_36, 
                          size=(total.n.26_36-screen.n.26_36), 
                          replace=FALSE)
screen.26_36 <- replace(screen.26_36, na_sample.26_36, NA)
sd(screen.26_36, na.rm = TRUE)
mean(screen.26_36, na.rm = TRUE)
# Final mean typically hovers between 40-47

screentime <- c(screen.6_11, screen.12_18, screen.19_25, screen.26_36)
```
*For each age group*, the following steps were taken: 
1. Use rnorm to simulate data with the total n for the age group, discounting NA's for the time being, because we need the full indices in order to combine into a later df with age. 
2. Replace negative values with 0. Because this will raise the mean, I lowered the initial mean chosen with rnorm. 
3. Add in NA values based on the difference in the total n and the n for touchscreen use. 

**Note:** The final standard deviation values are not ideal using this procedure, but I decided that staying closer to the true mean (found in the original data set) was more important.


## Sex
```{r}
sex.6_11 <- rep(x = "Female", times = total.n.6_11)
male_sample.6_11 <- sample(sex.6_11, 
                           size = ceiling(total.n.6_11*0.5149), 
                           replace=FALSE)
sex.6_11 <- replace(sex.6_11, male_sample.6_11, "Male")


sex.12_18 <- rep(x = "Female", times = total.n.12_18)
male_sample.12_18 <- sample(sex.12_18, 
                            size = ceiling(total.n.12_18*0.5302), 
                            replace=FALSE)
sex.12_18 <- replace(sex.12_18, male_sample.12_18, "Male")


sex.19_25 <- rep(x = "Female", times = total.n.19_25)
male_sample.19_25 <- sample(sex.19_25, 
                            size = ceiling(total.n.19_25*0.5587), 
                            replace=FALSE)
sex.19_25 <- replace(sex.19_25, male_sample.19_25, "Male")


sex.26_36 <- rep(x = "Female", times = total.n.26_36)
male_sample.26_36 <- sample(sex.26_36, 
                            size = ceiling(total.n.26_36*0.5134), 
                            replace=FALSE)
sex.26_36 <- replace(sex.26_36, male_sample.26_36, "Male")

sex <- c(sex.6_11, sex.12_18, sex.19_25, sex.26_36)

```

*For each age group*, the following steps were taken: 
1. Use rep to create a vector with the total length N with "Female" as each value
2. Replace "Female" with "Male" based on the percetage of the age group that is male in the original data set


## Background TV

```{r}

tv.6_11 <- rnorm(total.n.6_11, mean=(209.72-10), sd=186.08)
tv.6_11 <- replace(tv.6_11, tv.6_11<0, 0)
na.tv.sample <- sample(tv.6_11, 
                       size=(total.n.6_11-tv.n.6_11), 
                       replace=FALSE)
tv.6_11 <- replace(tv.6_11, na.tv.sample, NA)
mean(tv.6_11, na.rm=TRUE)
# Final mean falls between 190-220

tv.12_18 <- rnorm(total.n.12_18, mean=(189.62-17), sd=172.70)
tv.12_18 <- replace(tv.12_18, tv.12_18<0, 0)
na.tv.sample <- sample(tv.12_18, 
                       size=(total.n.12_18-tv.n.12_18), 
                       replace=FALSE)
tv.12_18 <- replace(tv.12_18, na.tv.sample, NA)
mean(tv.12_18, na.rm=TRUE)
# Final mean falls between 170-200

tv.19_25 <- rnorm(total.n.19_25, mean=(187.00-12), sd=162.99)
tv.19_25 <- replace(tv.19_25, tv.19_25<0, 0)
na.tv.sample <- sample(tv.19_25, 
                       size=(total.n.19_25-tv.n.19_25), 
                       replace=FALSE)
tv.19_25 <- replace(tv.19_25, na.tv.sample, NA)
mean(tv.19_25, na.rm=TRUE)
# Final mean falls between 170-210
# Larger variation than previous age group because there's a smaller sample size


tv.26_36 <- rnorm(total.n.26_36, mean=(219.01-7), sd=175.99)
tv.26_36 <- replace(tv.26_36, tv.26_36<0, 0)
na.tv.sample <- sample(tv.26_36, 
                       size=(total.n.26_36-tv.n.26_36), 
                       replace=FALSE)
tv.26_36 <- replace(tv.26_36, na.tv.sample, NA)
mean(tv.26_36, na.rm=TRUE)
# Final mean falls between 205-235

```

*For each age group*, the following steps were taken: 
1. Use rnorm to simulate data with the total n for the age group, discounting NA's for the time being, because we need the full indices in order to combine into a later df with age. 
2. Replace negative values with 0. Because this will raise the mean, I lowered the initial mean chosen with rnorm. 
3. Add in NA values based on the difference in the total n and the n for touchscreen use. 

**Note:** The final standard deviation values are not ideal using this procedure, but I decided that staying closer to the true mean (found in the original data set) was more important.



# Data Exploration

# Modeling

## Basic Regression

## Multivariate Multiple Regression

## Path Analysis